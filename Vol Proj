import pandas as pd
import numpy as np
import yfinance as yf
import matplotlib.pyplot as plt

data = yf.download("MSTR", start="2015-01-01")
print(data.head())
returns = np.log(data["Close"] / data["Close"].shift(1))
returns = returns.dropna()
plt.figure()
plt.plot(returns)
plt.title("log returns")
plt.show()
rolling_vol = returns.rolling(window=2).std()

plt.figure()
plt.plot(rolling_vol)
plt.title("Volatility Rolling (2 Days)")
plt.show()

from arch import arch_model
model = arch_model(returns * 100, vol="Garch", p=1, q=1)
result = model.fit()
print(result.summary())
plt.figure()
plt.plot(data["Close"])
plt.title("MSTR Price")
plt.xlabel("Time")
plt.ylabel("Price")
plt.show()
